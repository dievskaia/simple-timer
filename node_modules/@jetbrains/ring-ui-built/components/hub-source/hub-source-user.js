import HTTP from '../http/http.js';
import '../global/url.js';

const DEFAULT_FIELDS = 'id,name,login,banned,banReason,profile(email/email,avatar/url)';
function convertUserForCard(hubUser, serverUri = '') {
  return {
    name: hubUser.name,
    login: hubUser.login,
    banned: hubUser.banned,
    banReason: hubUser.banReason,
    email: hubUser.profile?.email?.email,
    avatarUrl: hubUser.profile?.avatar?.url,
    href: `${serverUri}users/${hubUser.id}`
  };
}
function createHubUserCardSource(auth, userId, fields = DEFAULT_FIELDS) {
  const http = new HTTP(auth);
  return async function getHubUser() {
    const hubUser = await http.get(`${auth.config.serverUri}api/rest/users/${userId}?fields=${fields}`);
    return convertUserForCard(hubUser, auth.config.serverUri);
  };
}

export { convertUserForCard, createHubUserCardSource };
