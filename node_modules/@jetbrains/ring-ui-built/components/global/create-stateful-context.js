import { c } from 'react-compiler-runtime';
import { memo, createContext, useState, useContext, useEffect } from 'react';
import { jsx } from 'react/jsx-runtime';

function createStatefulContext(initialValue, name = '') {
  const ValueContext = /*#__PURE__*/createContext(initialValue);
  const UpdateContext = /*#__PURE__*/createContext(() => {});
  function Provider(t0) {
    const $ = c(6);
    if ($[0] !== "576d375e78a62076caf2193d98749eebdfd60d1ce7b219f4ea1f080358177a6e") {
      for (let $i = 0; $i < 6; $i += 1) {
        $[$i] = Symbol.for("react.memo_cache_sentinel");
      }
      $[0] = "576d375e78a62076caf2193d98749eebdfd60d1ce7b219f4ea1f080358177a6e";
    }
    const {
      children
    } = t0;
    const [value, update] = useState(initialValue);
    let t1;
    if ($[1] !== children) {
      t1 = /*#__PURE__*/jsx(UpdateContext.Provider, {
        value: update,
        children: children
      });
      $[1] = children;
      $[2] = t1;
    } else {
      t1 = $[2];
    }
    let t2;
    if ($[3] !== t1 || $[4] !== value) {
      t2 = /*#__PURE__*/jsx(ValueContext.Provider, {
        value: value,
        children: t1
      });
      $[3] = t1;
      $[4] = value;
      $[5] = t2;
    } else {
      t2 = $[5];
    }
    return t2;
  }
  Provider.displayName = `${name}Provider`;
  function useUpdate(value, skipUpdate) {
    const $ = c(6);
    if ($[0] !== "576d375e78a62076caf2193d98749eebdfd60d1ce7b219f4ea1f080358177a6e") {
      for (let $i = 0; $i < 6; $i += 1) {
        $[$i] = Symbol.for("react.memo_cache_sentinel");
      }
      $[0] = "576d375e78a62076caf2193d98749eebdfd60d1ce7b219f4ea1f080358177a6e";
    }
    const update = useContext(UpdateContext);
    let t0;
    let t1;
    if ($[1] !== skipUpdate || $[2] !== update || $[3] !== value) {
      t0 = () => {
        if (!skipUpdate) {
          update(value);
        }
      };
      t1 = [update, value, skipUpdate];
      $[1] = skipUpdate;
      $[2] = update;
      $[3] = value;
      $[4] = t0;
      $[5] = t1;
    } else {
      t0 = $[4];
      t1 = $[5];
    }
    useEffect(t0, t1);
  }
  function Updater(t0) {
    const $ = c(1);
    if ($[0] !== "576d375e78a62076caf2193d98749eebdfd60d1ce7b219f4ea1f080358177a6e") {
      for (let $i = 0; $i < 1; $i += 1) {
        $[$i] = Symbol.for("react.memo_cache_sentinel");
      }
      $[0] = "576d375e78a62076caf2193d98749eebdfd60d1ce7b219f4ea1f080358177a6e";
    }
    const {
      value,
      skipUpdate
    } = t0;
    useUpdate(value, skipUpdate);
    return null;
  }
  Updater.displayName = `${name}Updater`;
  return {
    ValueContext,
    UpdateContext,
    Provider,
    useUpdate,
    Updater: /*#__PURE__*/memo(Updater)
  };
}

export { createStatefulContext as default };
