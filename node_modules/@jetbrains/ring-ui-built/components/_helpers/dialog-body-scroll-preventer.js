import scrollbarWidth from 'scrollbar-width';

var styles = {"header":"ring-island-header","scrollableWrapper":"ring-island-scrollableWrapper","panel":"ring-panel-panel","container":"ring-dialog-container","nativeDialog":"ring-dialog-nativeDialog","innerContainer":"ring-dialog-innerContainer","content":"ring-dialog-content","clickableOverlay":"ring-dialog-clickableOverlay","closeIconOutside":"ring-dialog-closeIconOutside","closeIcon":"ring-dialog-closeIcon","closeButton":"ring-dialog-closeButton","closeButtonOutside":"ring-dialog-closeButtonOutside","closeButtonInside":"ring-dialog-closeButtonInside","documentWithoutScroll":"ring-dialog-documentWithoutScroll","popupTarget":"ring-dialog-popupTarget","dense":"ring-dialog-dense"};

const isPrevented = new Set();
let previousDocumentWidth = null;
const prevent = key => {
  if (isPrevented.has(key)) {
    return;
  }
  isPrevented.add(key);
  if (isPrevented.size > 1) {
    return;
  }
  const documentHasScroll = document.documentElement.scrollHeight > window.innerHeight || getComputedStyle(document.documentElement).overflowY === 'scroll';
  document.documentElement.classList.add(styles.documentWithoutScroll);
  const scrollWidth = scrollbarWidth();
  const {
    scrollbarGutter
  } = getComputedStyle(document.documentElement);
  const documentHasScrollbarGutter = scrollbarGutter === 'stable' || scrollbarGutter === 'both-edges';
  if (documentHasScroll && scrollWidth !== null && scrollWidth !== undefined && scrollWidth > 0 && !documentHasScrollbarGutter) {
    previousDocumentWidth = document.documentElement.style.width;
    document.documentElement.style.width = `calc(100% - ${scrollWidth}px)`;
  }
};
const reset = key => {
  if (isPrevented.size === 0) {
    return;
  }
  isPrevented.delete(key);
  if (isPrevented.size > 0) {
    return;
  }
  document.documentElement.classList.remove(styles.documentWithoutScroll);
  if (previousDocumentWidth !== null && previousDocumentWidth !== undefined) {
    document.documentElement.style.width = previousDocumentWidth;
    previousDocumentWidth = null;
  }
};
const preventerFactory = key => {
  const preventerKey = key || Math.random();
  return {
    prevent: () => prevent(preventerKey),
    reset: () => reset(preventerKey)
  };
};
var dialogBodyScrollPreventer = preventerFactory('default-preventer');

export { dialogBodyScrollPreventer as d, preventerFactory as p, styles as s };
